<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
  <meta name="generator" content="HTML Tidy for Linux (vers 11 February 2007), see www.w3.org">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

  <title>10.2. å¼‚å¸¸æ¨¡å¼</title>
  <link href="styles.css" tppabs="http://www.laruence.com/manual/css/styles.css" rel="stylesheet" type="text/css">
  <meta content="Zoeey Doc Generator" name="generator">
  <link rel="home" href="index.html" title="Yaf(Yet Another Framework)ç”¨æˆ·æ‰‹å†Œ">
  <link rel="up" href="yaf.catcherror.html" title="ç¬¬ 10 ç«  å¼‚å¸¸å’Œé”™è¯¯">
  <link rel="prev" href="yaf.catcherror.html" title="ç¬¬ 10 ç«  å¼‚å¸¸å’Œé”™è¯¯">
  <link rel="next" href="yaf.catcherror.error.html" title="10.3. é”™è¯¯æ¨¡å¼">
</head>

<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
  <div class="navheader">
    <table summary="Navigation header" width="100%">
      <tr>
        <th align="center" colspan="3">10.2. å¼‚å¸¸æ¨¡å¼</th>
      </tr>

      <tr>
        <td align="left" width="20%"><a accesskey="p" href="yaf.catcherror.html" tppabs="http://www.laruence.com/manual/yaf.catcherror.html">ä¸Šä¸€é¡µ</a>&nbsp;</td>

        <th align="center" width="60%">ç¬¬ 10 ç«  å¼‚å¸¸å’Œé”™è¯¯</th>

        <td align="right" width="20%">&nbsp;<a accesskey="n" href="yaf.catcherror.error.html" tppabs="http://www.laruence.com/manual/yaf.catcherror.error.html">ä¸‹ä¸€é¡µ</a></td>
      </tr>
    </table>
    <hr>
  </div>

  <div class="sect1" title="10.2. å¼‚å¸¸æ¨¡å¼">
    <div class="titlepage">
      <div>
        <div>
          <h2 class="title" style="clear: both"><a name="yaf.catcherror.exception" id=
          "yaf.catcherror.exception"></a>10.2. å¼‚å¸¸æ¨¡å¼</h2>
        </div>
      </div>
    </div>

    <p>åœ¨<a class="link" href="yaf.config.optional.html" tppabs="http://www.laruence.com/manual/yaf.config.optional.html" title=
    "4.2. å¯é€‰çš„é…ç½®é¡¹">application.dispatcher.catchException</a>(é…ç½®æ–‡ä»¶, æˆ–è€…å¯é€šè¿‡Yaf_Dispatcher::catchException(true))å¼€å¯çš„æƒ…å†µä¸‹,
    å½“Yafé‡åˆ°æœªæ•è·å¼‚å¸¸çš„æ—¶å€™, å°±ä¼šæŠŠè¿è¡Œæƒé™, äº¤ç»™å½“å‰æ¨¡å—çš„Error Controllerçš„Error ActionåŠ¨ä½œ, è€Œå¼‚å¸¸æˆ–ä½œä¸ºè¯·æ±‚çš„ä¸€ä¸ªå‚æ•°, ä¼ é€’ç»™Error Action.</p>

    <p>åœ¨Error Actionä¸­å¯ä»¥é€šè¿‡$request-&gt;getRequest()-&gt;getParam("exception")è·å–å½“å‰å‘ç”Ÿçš„å¼‚å¸¸.</p>

    <div class="important" title="é‡è¦" style="margin-left: 0.5in; margin-right: 0.5in;">
      <table border="0" summary="Important">
        <tr>
          <td valign="top" align="center" rowspan="2" width="25"><img alt="[é‡è¦]" src="important.gif" tppabs="http://www.laruence.com/manual/images/important.gif"></td>

          <th align="left">é‡è¦</th>
        </tr>

        <tr>
          <td valign="top" align="left">ä»Yaf1.0.0.12å¼€å§‹, ä¹Ÿå¯ä»¥é€šè¿‡$request-&gt;getException()æ¥è·å–å½“å‰å‘ç”Ÿçš„å¼‚å¸¸, è€Œå¦‚æœError
          Actionå®šä¹‰äº†ä¸€ä¸ªåä¸º$exceptionçš„å‚æ•°çš„è¯, ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªå‚æ•°è·å–å½“å‰å‘ç”Ÿçš„å¼‚å¸¸.</td>
        </tr>
      </table>
    </div>

    <div class="example">
      <a name="N209B7" id="N209B7"></a>

      <p class="title"><b>ä¾‹ 10.1. Error Controller</b></p>

      <div class="example-contents">
        <pre class="programlisting">
     
&lt;?php

/**
 * å½“æœ‰æœªæ•è·çš„å¼‚å¸¸, åˆ™æ§åˆ¶æµä¼šæµåˆ°è¿™é‡Œ
 */
class ErrorController extends Yaf_Controller_Abstract {
 /**
  * ä¹Ÿå¯é€šè¿‡$request-&gt;getException()è·å–åˆ°å‘ç”Ÿçš„å¼‚å¸¸
  */
        public function errorAction($exception) {
      assert($exception === $exception-&gt;getCode());
      $this-&gt;getView()-&gt;assign("code", $exception-&gt;getCode());
      $this-&gt;getView()-&gt;assign("message", $exception-&gt;getMessage());
        }
     
    
</pre>
      </div>
    </div>

    <p><br class="example-break"></p>

    <p>æœ‰äº†è¿™æ ·çš„æœ€ç»ˆå¼‚å¸¸å¤„ç†é€»è¾‘, åº”ç”¨å°±å¯ä»¥åœ¨å‡ºé”™çš„æ—¶å€™ç›´æ¥æŠ›å‡ºå¼‚å¸¸, åœ¨ç»Ÿä¸€å¼‚å¸¸å¤„ç†é€»è¾‘ä¸­, æ ¹æ®å„ç§ä¸åŒçš„å¼‚å¸¸é€»è¾‘, å¤„ç†é”™è¯¯, è®°å½•æ—¥å¿—. ä¸€ä¸ªå¸¸ç”¨çš„Error Actionå¦‚ä¸‹:</p>

    <div class="example">
      <a name="N209C4" id="N209C4"></a>

      <p class="title"><b>ä¾‹ 10.2.</b></p>

      <div class="example-contents">
        <pre class="programlisting">
     
&lt;?php

/**
 * å½“æœ‰æœªæ•è·çš„å¼‚å¸¸, åˆ™æ§åˆ¶æµä¼šæµåˆ°è¿™é‡Œ
 */
class ErrorController extends Yaf_Controller_Abstract {
 /**
  * ä¹Ÿå¯é€šè¿‡$request-&gt;getException()è·å–åˆ°å‘ç”Ÿçš„å¼‚å¸¸
  */
        public function errorAction($exception) {
  switch($exception-&gt;getCode()) {
      case YAF_ERR_LOADFAILD:
      case YAF_ERR_LOADFAILD_MODULE:
      case YAF_ERR_LOADFAILD_CONTROLLER:
      case YAF_ERR_LOADFAILD_ACTION:
      //404
      header("Not Found");
      break;

      case CUSTOM_ERROR_CODE:
      //è‡ªå®šä¹‰çš„å¼‚å¸¸
      ....
      break;
  }
        }
    
    
</pre>
      </div>
    </div>

    <p><br class="example-break">
    å½“ç„¶, ä¸€ä¸ªæ›´ä¸ºæ˜“è¯»çš„æ–¹å¼:</p>

    <div class="example">
      <a name="N209CB" id="N209CB"></a>

      <p class="title"><b>ä¾‹ 10.3.</b></p>

      <div class="example-contents">
        <pre class="programlisting">
     
&lt;?php

/**
 * å½“æœ‰æœªæ•è·çš„å¼‚å¸¸, åˆ™æ§åˆ¶æµä¼šæµåˆ°è¿™é‡Œ
 */
class ErrorController extends Yaf_Controller_Abstract {
 /**
  * æ­¤æ—¶å¯é€šè¿‡$request-&gt;getException()è·å–åˆ°å‘ç”Ÿçš„å¼‚å¸¸
  */
        public function errorAction() {
  $exception = $this-&gt;getRequest()-&gt;getException();
  try {
    throw $exception;
  } catch (Yaf_Exception_LoadFailed $e) {
    //åŠ è½½å¤±è´¥
  } catch (Yaf_Exception $e) {
    //å…¶ä»–é”™è¯¯
  }
        }
    
    
</pre>
      </div>
    </div>

    <p><br class="example-break"></p>
  </div>

  <div class="navfooter">
    <hr>

    <table summary="Navigation footer" width="100%">
      <tr>
        <td align="left" width="40%"><a accesskey="p" href="yaf.catcherror.html" tppabs="http://www.laruence.com/manual/yaf.catcherror.html">ä¸Šä¸€é¡µ</a>&nbsp;</td>

        <td align="center" width="20%"><a accesskey="u" href="yaf.catcherror.html" tppabs="http://www.laruence.com/manual/yaf.catcherror.html">ä¸Šä¸€çº§</a></td>

        <td align="right" width="40%">&nbsp;<a accesskey="n" href="yaf.catcherror.error.html" tppabs="http://www.laruence.com/manual/yaf.catcherror.error.html">ä¸‹ä¸€é¡µ</a></td>
      </tr>

      <tr>
        <td valign="top" align="left" width="40%">ç¬¬ 10 ç«  å¼‚å¸¸å’Œé”™è¯¯&nbsp;</td>

        <td align="center" width="20%"><a accesskey="h" href="index.html" tppabs="http://www.laruence.com/manual/index.html">èµ·å§‹é¡µ</a></td>

        <td valign="top" align="right" width="40%">&nbsp;10.3. é”™è¯¯æ¨¡å¼</td>
      </tr>
    </table>
  </div>
</body>
<script type="text/javascript" src="tongji.js" tppabs="http://js.tongji.linezing.com/728491/tongji.js"></script><noscript><a href="javascript:if(confirm('http://www.linezing.com/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://www.linezing.com/'" tppabs="http://www.linezing.com/"><img src="tongji.gif" tppabs="http://img.tongji.linezing.com/728491/tongji.gif"/></a></noscript>
</html>
